/*! jquery-stone - v0.0.0 - 2012-07-02
* Copyright (c) 2012 Satoshi Ohki; Licensed MIT, GPLv2 */
(function(a,b,c){function h(b){this.options=a.extend({},f,b),this._defaults=f,this._name=d,this._buffer={},this.init()}"use strict";var d="stone",e="0.0.0",f={dataScheme:"jqstone",enableEngines:[],saveStrategy:"fallback",syncBufferLimit:0},g={};h.prototype={init:function(){var a=this.options.enableEngines[0];this.database=g[a]},get:function(b,c){var d=a.extend({},c),e=this.getDataUrl(b),f=null;return e in this._buffer?f=this._buffer[e]:(f=this.database.get.call(this,e,d),this.database.deserialize&&(f=this.database.deserialize.call(this,f)),this._buffer[e]=f),f&&f.value},set:function(b,c,d){var e=a.extend({},d),f=this.getDataUrl(b),g=e.expires,h={value:typeof c=="undefined"?null:c};if(g instanceof Date)h.timestamp=g.getTime();else if(typeof g=="number"){var i=new Date;i.setTime(i.getTime()+g),h.timestamp=i.getTime()}return this.database.serialize&&(h=this.database.serialize.call(this,h)),this.database.set.call(this,f,h,e),delete this._buffer[f],this},remove:function(a,b){var c=this.getDataUrl(a);return this.database.remove.call(this,c,b),delete this._buffer[c],this},clear:function(){return this.database.clear.call(this,new RegExp(this.getDataUrl(""))),this._buffer={},this},getDataUrl:function(a){return this.options.dataScheme+"://"+a}},a[d]={_version:function(){return e},_defaults:function(){return f},availableEngines:function(){return g},unregisterStorageEngine:function(a){delete g[a]},registerStorageEngine:function(a,b){b.isAvailable()&&(g[a]=b)},create:function(a){return new h(a)}}})(jQuery,this),function(a,b,c){"use strict";var d="stone";return a[d].registerStorageEngine("cookie",{isAvailable:function(){return"cookie"in document},set:function(a,b,c){var d=JSON.stringify(b);localStorage.setItem(a,d)},get:function(a,b){var c=localStorage.getItem(a),d=null;try{d=JSON.parse(c)}catch(e){d=null}return d},remove:function(a,b){localStorage.removeItem(a)},clear:function(a){if(a)for(var b=0,c=localStorage.length;b<c;b++){var d=localStorage.key(b);d.match(a)&&localStorage.removeItem(d)}else localStorage.clear()}}),a}(jQuery,this),function(a,b,c){"use strict";var d="stone";return a[d].registerStorageEngine("localStorage",{isAvailable:function(){try{return"localStorage"in window&&window.localStorage!==null}catch(a){return!1}},serialize:function(a){return typeof a=="undefined"||a===null?null:typeof a=="object"||typeof a=="string"?JSON.stringify(a):a},deserialize:function(a){var b=null;try{b=JSON.parse(a)}catch(c){b=null}return b},set:function(a,b,c){localStorage.setItem(a,b)},get:function(a,b){return localStorage.getItem(a)},remove:function(a,b){localStorage.removeItem(a)},clear:function(a){if(a)for(var b=0,c=localStorage.length;b<c;b++){var d=localStorage.key(b);d.match(a)&&localStorage.removeItem(d)}else localStorage.clear()}}),a}(jQuery,this);